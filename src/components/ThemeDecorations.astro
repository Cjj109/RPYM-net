---
/**
 * RPYM - Decoraciones temáticas
 * Renderiza elementos decorativos animados según el tema activo
 */
---

<div class="theme-decorations" id="theme-decorations" aria-hidden="true">
  <!-- Las decoraciones se insertan dinámicamente via JavaScript -->
</div>

<script is:inline>
(function() {
  const container = document.getElementById('theme-decorations');
  if (!container) return;

  // Configuración de decoraciones por tema
  const decorations = {
    ocean: {
      count: 8,
      create: (i) => {
        const bubble = document.createElement('div');
        bubble.className = 'bubble';
        bubble.style.left = `${Math.random() * 100}%`;
        bubble.style.animationDuration = `${8 + Math.random() * 12}s`;
        bubble.style.animationDelay = `${Math.random() * 10}s`;
        bubble.style.width = `${10 + Math.random() * 20}px`;
        bubble.style.height = bubble.style.width;
        bubble.style.opacity = `${0.3 + Math.random() * 0.4}`;
        return bubble;
      }
    },
    carnival: {
      count: 25,
      create: (i) => {
        const colors = ['#a855f7', '#eab308', '#22c55e', '#ec4899', '#f97316'];
        const confetti = document.createElement('div');
        confetti.className = 'confetti-piece';
        confetti.style.left = `${Math.random() * 100}%`;
        confetti.style.backgroundColor = colors[i % colors.length];
        confetti.style.animationDuration = `${5 + Math.random() * 8}s`;
        confetti.style.animationDelay = `${Math.random() * 10}s`;
        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
        confetti.style.width = `${6 + Math.random() * 8}px`;
        confetti.style.height = `${6 + Math.random() * 8}px`;
        confetti.style.opacity = `${0.6 + Math.random() * 0.4}`;
        return confetti;
      }
    },
    christmas: {
      count: 30,
      create: (i) => {
        const element = document.createElement('div');
        // Variedad de elementos: copos (60%), esferas rojas (15%), esferas verdes (15%), estrellas (10%)
        const type = i % 10;
        if (type < 6) {
          // Copos de nieve (tipos variados)
          element.className = i % 3 === 0 ? 'snowflake-star' : 'snowflake';
          const size = 6 + Math.random() * 10;
          element.style.setProperty('--snow-size', `${size}px`);
        } else if (type < 7) {
          // Esferas rojas
          element.className = 'christmas-ornament';
          const size = 8 + Math.random() * 6;
          element.style.setProperty('--ornament-size', `${size}px`);
        } else if (type < 8) {
          // Esferas verdes
          element.className = 'christmas-ornament-green';
          const size = 8 + Math.random() * 6;
          element.style.setProperty('--ornament-size', `${size}px`);
        } else {
          // Estrellas doradas
          element.className = 'christmas-star';
          const size = 10 + Math.random() * 8;
          element.style.setProperty('--star-size', `${size}px`);
        }
        element.style.left = `${Math.random() * 100}%`;
        element.style.opacity = `${0.6 + Math.random() * 0.4}`;
        const duration = 8 + Math.random() * 10;
        const delay = Math.random() * 6;
        element.style.animation = `snowfall ${duration}s linear ${delay}s infinite, snow-sway 3s ease-in-out ${delay}s infinite`;
        return element;
      }
    },
    easter: {
      count: 15,
      create: (i) => {
        const colors = ['#f9a8d4', '#a78bfa', '#86efac', '#fde047', '#67e8f9'];
        const element = document.createElement('div');
        element.className = 'easter-egg';
        const size = 8 + Math.random() * 8;
        element.style.setProperty('--egg-size', `${size}px`);
        element.style.setProperty('--egg-color', colors[i % colors.length]);
        element.style.left = `${Math.random() * 100}%`;
        element.style.opacity = `${0.5 + Math.random() * 0.4}`;
        const duration = 7 + Math.random() * 6;
        const delay = Math.random() * 4;
        element.style.animation = `easter-fall ${duration}s linear ${delay}s infinite, easter-wobble 2s ease-in-out ${delay}s infinite`;
        return element;
      }
    },
    valentine: {
      count: 18,
      create: (i) => {
        const colors = ['#e11d48', '#f43f5e', '#fb7185', '#fda4af', '#be123c'];
        const heart = document.createElement('div');
        heart.className = 'valentine-heart';
        const size = 8 + Math.random() * 10;
        heart.style.setProperty('--heart-size', `${size}px`);
        heart.style.setProperty('--heart-color', colors[i % colors.length]);
        heart.style.left = `${Math.random() * 100}%`;
        heart.style.opacity = `${0.5 + Math.random() * 0.4}`;
        const duration = 6 + Math.random() * 6;
        const delay = Math.random() * 3;
        heart.style.animation = `heart-fall ${duration}s linear ${delay}s infinite, heart-sway 3s ease-in-out ${delay}s infinite`;
        return heart;
      }
    },
    mundial: {
      count: 20,
      create: (i) => {
        const element = document.createElement('div');
        // Variedad: balones (40%), estrellas (20%), trofeos (15%), confeti verde (15%), confeti dorado (10%)
        const type = i % 10;
        if (type < 4) {
          // Balones de fútbol
          element.className = 'mundial-ball';
          const size = 12 + Math.random() * 8;
          element.style.setProperty('--ball-size', `${size}px`);
        } else if (type < 6) {
          // Estrellas doradas
          element.className = 'mundial-star';
          const size = 10 + Math.random() * 8;
          element.style.setProperty('--star-size', `${size}px`);
        } else if (type < 7) {
          // Trofeos
          element.className = 'mundial-trophy';
          const size = 12 + Math.random() * 6;
          element.style.setProperty('--trophy-size', `${size}px`);
        } else if (type < 9) {
          // Confeti verde
          element.className = 'mundial-confetti green';
          const size = 6 + Math.random() * 6;
          element.style.setProperty('--confetti-size', `${size}px`);
        } else {
          // Confeti dorado
          element.className = 'mundial-confetti gold';
          const size = 6 + Math.random() * 6;
          element.style.setProperty('--confetti-size', `${size}px`);
        }
        element.style.left = `${Math.random() * 100}%`;
        element.style.opacity = `${0.6 + Math.random() * 0.4}`;
        const duration = 7 + Math.random() * 6;
        const delay = Math.random() * 6;
        element.style.animation = `mundial-fall ${duration}s linear ${delay}s infinite, mundial-spin 2s ease-in-out ${delay}s infinite`;
        return element;
      }
    },
    halloween: {
      count: 15,
      create: (i) => {
        const element = document.createElement('div');
        // Alternar entre murciélagos y calabazas
        element.className = i % 3 === 0 ? 'halloween-pumpkin' : 'halloween-bat';
        const size = element.className === 'halloween-pumpkin' ? (10 + Math.random() * 8) : (12 + Math.random() * 8);
        element.style.setProperty(element.className === 'halloween-pumpkin' ? '--pumpkin-size' : '--bat-size', `${size}px`);
        element.style.left = `${Math.random() * 100}%`;
        element.style.opacity = `${0.6 + Math.random() * 0.3}`;
        const duration = 6 + Math.random() * 6;
        const delay = Math.random() * 5;
        element.style.animation = `halloween-fall ${duration}s linear ${delay}s infinite, halloween-flutter 2s ease-in-out ${delay}s infinite`;
        return element;
      }
    }
  };

  let currentTheme = null;

  function renderDecorations(theme) {
    // Solo re-renderizar si el tema cambió
    if (currentTheme === theme) return;
    currentTheme = theme;

    // Limpiar decoraciones anteriores
    container.innerHTML = '';

    const config = decorations[theme];
    if (!config) return;

    // Crear nuevas decoraciones
    for (let i = 0; i < config.count; i++) {
      const element = config.create(i);
      container.appendChild(element);
    }
  }

  // Renderizar decoraciones iniciales
  function init() {
    const theme = document.documentElement.getAttribute('data-theme') || 'ocean';
    renderDecorations(theme);
  }

  // Observar cambios en el tema
  const observer = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if (mutation.attributeName === 'data-theme') {
        const newTheme = document.documentElement.getAttribute('data-theme') || 'ocean';
        renderDecorations(newTheme);
      }
    });
  });

  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ['data-theme']
  });

  // Inicializar cuando el DOM esté listo
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>
